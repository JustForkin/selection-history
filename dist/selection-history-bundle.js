!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);const s=new Map;class n{static get all(){return Array.from(s.values())}static add(t){s.set(t.el,t)}static getFromEl(t){return s.get(t)}static invalidateRectCache(){n.all.forEach(t=>t.cacheValid=!1)}constructor(t,e,i,s,o){this.el=document.createElement("div"),this.el.classList.add("selectable"),this.el.style.left=e.toString(),this.el.style.top=i.toString(),this.el.style.width=s.toString(),this.el.style.height=o.toString(),this._selected=!1,this.cacheValid=!1,this.cachedRect={x:0,y:0,width:0,height:0},t.appendChild(this.el),n.add(this)}updateSelectedClass(){this.selected?this.el.classList.add("selected"):this.el.classList.remove("selected")}get selected(){return this._selected}set selected(t){this._selected=t,this.updateSelectedClass()}get preview(){return this.el.classList.contains("preview")}set preview(t){t?this.el.classList.add("preview"):this.el.classList.remove("preview")}get rect(){if(!this.cacheValid){const t=this.el.getBoundingClientRect();this.cachedRect={x:t.left,y:t.top,width:t.width,height:t.height},this.cacheValid=!0}return this.cachedRect}cloneEl(){return this.el.cloneNode()}}window.addEventListener("resize",()=>{n.invalidateRectCache()},!1),window.addEventListener("scroll",()=>{n.invalidateRectCache()},!1);class o{constructor(t){this._value=t,this.subscriptions=[]}get value(){return this._value}set value(t){this._value=t,this.notify()}setValueWithoutNotify(t){this._value=t}subscribe(t){this.subscriptions.push(t)}unsubscribe(t){this.subscriptions=this.subscriptions.filter(e=>e!==t)}notify(){this.subscriptions.forEach(t=>t(this.value))}}class h{constructor(t){this.historyItem=t,this.onAnyButtonClick=(()=>{}),this.onAnyButtonEnter=(()=>{}),this.onAnyButtonLeave=(()=>{}),this.el=document.createElement("div"),this.el.classList.add("history-item"),this.el.style.height="34.5vh",this._label=1,this.labelEl=document.createElement("div"),this.labelEl.classList.add("history-label"),this.el.appendChild(this.labelEl),this.previewEl=document.createElement("div"),this.previewEl.classList.add("preview-view"),this.el.appendChild(this.previewEl),this.addButtonAction(this.previewEl,t=>t,!1),this.buttonsEl=document.createElement("div"),this.buttonsEl.classList.add("buttons"),this.el.appendChild(this.buttonsEl),this.previewStates=new Map,this.historyItem.forEach((t,e)=>{const i=e.cloneEl();t?i.classList.add("selected"):i.classList.remove("selected"),i.classList.remove("hover"),this.previewEl.appendChild(i)}),[{name:"add",states:{a:"active",b:"active",c:"active"},check:(t,e)=>e||t},{name:"subtract",states:{a:"active",b:"inactive",c:"inactive"},check:(t,e)=>e&&!t},{name:"xor",states:{a:"active",b:"inactive",c:"active"},check:(t,e)=>Boolean(Number(t)^Number(e))},{name:"intersection",states:{a:"inactive",b:"active",c:"inactive"},check:(t,e)=>e&&t},{name:"inverse",states:{a:"active",b:"inactive",c:"inactive"},check:t=>!t}].forEach((t,e,i)=>{const s=document.createElement("div");s.classList.add("button"),s.classList.add(t.name),s.setAttribute("title",t.name),this.previewStates.set(s,!1),["a","b","c"].forEach(e=>{const i=`rect-${e}`,n=document.createElement("div");n.classList.add("rect",i,t.states[e]),s.appendChild(n)}),s.style.height=`${100/i.length}%`,this.buttonsEl.appendChild(s),this.addButtonAction(s,t.check,!0)})}addButtonAction(t,e,i){t.classList.add("button");const s=()=>this.onAnyButtonClick(e);if(t.addEventListener("click",s,!1),t.addEventListener("mouseenter",()=>{this.onAnyButtonEnter(e)},!1),t.addEventListener("mouseleave",()=>{this.onAnyButtonLeave()},!1),i){let i=!1;t.addEventListener("touchstart",()=>{i||(t.removeEventListener("click",s,!1),i=!0),Array.from(this.previewStates.keys()).filter(e=>e!==t).forEach(t=>this.previewStates.set(t,!1));const n=this.previewStates.get(t);n?this.onAnyButtonClick(e):this.onAnyButtonEnter(e),this.previewStates.set(t,!n)},{passive:!0,capture:!1})}}get label(){return this._label}set label(t){this._label=t,this.labelEl.textContent=`${t}`}slideIn(t){this.el.style.marginTop=`-${this.el.style.height}`,this.el.classList.add("first"),this.el.style.animationDuration=`${t}Ms`,this.el.style.height=this.el.style.height}}function c(t,e){return Math.floor(t+Math.random()*(e-t))}const r=document.createElement("div");r.id="left",document.body.appendChild(r);const a=document.createElement("div");a.id="right",document.body.appendChild(a);const l=document.createElement("div");l.classList.add("container"),r.appendChild(l);l.style.height="69vh",Array.from(Array(4)).forEach((t,e)=>{const i=document.createElement("div");i.classList.add("track"),3===e&&i.classList.add("last"),i.style.height="17.25vh",l.appendChild(i);const s=t=>{const i=`${t}%`,o=`${25*e}%`,h=100-t,r=Math.min(c(5,20),h);new n(l,i,o,`${r}%`,"25%");const a=t+r+c(0,25);a>95||s(a)};s(0)}),new class{constructor(t){this.parentEl=t,this.parentRectCached={x:0,y:0,width:0,height:0},this.parentRectCacheValid=!1,window.addEventListener("resize",()=>{this.parentRectCacheValid=!1},!1),this.el=document.createElement("div"),this.el.classList.add("drag-selection"),document.body.appendChild(this.el),this.selectionStateObs=new o([]),this.isPointerDown=!1,this.clickPoint={x:0,y:0},this.previousSelectionState=new Map,this._tl={x:0,y:0},this._br={x:100,y:100},this.isDragSelecting=!1,this.inputPoint={x:0,y:0},this.isCombining=!1,t.addEventListener("mousedown",t=>this.onMouseDown(t),!1),document.addEventListener("mousemove",t=>this.onMouseMove(t),!1),document.addEventListener("mouseup",t=>this.onMouseUp(t),!1),t.addEventListener("touchstart",t=>this.onTouchStart(t),{passive:!0,capture:!1}),document.addEventListener("touchmove",t=>this.onTouchMove(t),!1),document.addEventListener("touchend",t=>this.onTouchEnd(t),!1),document.addEventListener("keydown",t=>this.onKeyDown(t),!1),document.addEventListener("keyup",t=>this.onKeyUp(t),!1)}get selectionState(){return this.selectionStateObs.value}set selectionState(t){this.selectionStateObs.value=t}get isCombining(){return this._combining}set isCombining(t){this._combining=t,this.isCombining?document.body.classList.add("isCombining"):document.body.classList.remove("isCombining")}get isDragSelecting(){return this._isDragSelecting}set isDragSelecting(t){this._isDragSelecting=t,t?document.body.classList.add("isDragSelecting"):document.body.classList.remove("isDragSelecting")}updateTransform(){const t=`translate3d(${this.tl.x}px, ${this.tl.y}px, 0)`,e=`scale3d(${this.br.x-this.tl.x}, ${this.br.y-this.tl.y}, 1)`;this.el.style.transform=`${t} ${e}`}get tl(){return this._tl}set tl(t){this._tl=t,this.updateTransform()}get parentRect(){if(!this.parentRectCacheValid){const t=this.parentEl.getBoundingClientRect();this.parentRectCached={x:t.left,y:t.top,width:t.width,height:t.height},this.parentRectCacheValid=!0}return this.parentRectCached}get br(){return this._br}set br(t){this._br={x:Math.min(t.x,this.parentRect.x+this.parentRect.width),y:t.y},this.updateTransform()}onKeyDown(t){["ShiftLeft","ShiftRight"].includes(t.code)&&(this.isCombining=!0,this.isDragSelecting&&this.updateSelection())}onKeyUp(t){["ShiftLeft","ShiftRight"].includes(t.code)&&!t.shiftKey&&(this.isCombining=!1,this.isDragSelecting&&this.updateSelection())}getPointFromEvent(t){return{x:t.clientX,y:t.clientY}}onMouseDown(t){this.touchedTarget=t.target,this.inputPoint=this.getPointFromEvent(t),this.onPointerDown()}onMouseMove(t){this.inputPoint=this.getPointFromEvent(t),this.onPointerMove()}onMouseUp(t){this.inputPoint=this.getPointFromEvent(t),this.onPointerUp()}updateTouchInputPoints(t){if(0===t.changedTouches.length)return;const e=t.changedTouches[0];this.inputPoint=this.getPointFromEvent(e)}onTouchStart(t){this.touchedTarget=t.target,this.updateTouchInputPoints(t),this.onPointerDown()}onTouchMove(t){this.updateTouchInputPoints(t),this.onPointerMove()}onTouchEnd(t){this.updateTouchInputPoints(t),this.onPointerUp()}onPointerDown(){this.isPointerDown=!0,this.previousSelectionState=new Map(n.all.map(t=>[t,t.selected]));const t=void 0===this.touchedTarget?void 0:n.getFromEl(this.touchedTarget),e=t instanceof n;this.isCombining?e&&(t.selected=!t.selected):n.all.forEach(i=>{i.selected=!!e&&i===t}),this.tl=this.inputPoint,this.br=this.inputPoint,this.clickPoint=this.inputPoint}overlapsRect(t){return this.tl.x<t.x+t.width&&this.br.x>t.x&&this.tl.y<t.y+t.height&&this.br.y>t.y}updateSelection(){this.tl={x:Math.min(this.inputPoint.x,this.clickPoint.x),y:Math.min(this.inputPoint.y,this.clickPoint.y)},this.br={x:Math.max(this.inputPoint.x,this.clickPoint.x),y:Math.max(this.inputPoint.y,this.clickPoint.y)},n.all.forEach(t=>{const e=this.overlapsRect(t.rect),i=!!this.previousSelectionState.has(t)&&this.previousSelectionState.get(t);t.selected=this.isCombining?e?!i:i:e})}onPointerMove(){this.isPointerDown&&!this.isDragSelecting&&(this.isDragSelecting=!0),this.isDragSelecting&&this.updateSelection()}onPointerUp(){this.isPointerDown=!1,this.isDragSelecting=!1,this.selectionState=n.all}}(r).selectionStateObs.subscribe(t=>{d.currentSelection=t});const d=new class{constructor(){this.el=document.createElement("div"),this.el.classList.add("selection-history"),this.currentSelectionObs=new o([]),this.historyObs=new o([]),this.canPreview=!0,this.historyItemViews=[],this.currentSelectionObs.subscribe(t=>{this.addToHistory(new Map(t.map(t=>[t,t.selected])))}),this.historyObs.subscribe(t=>this.render(t[0]))}get currentSelection(){return this.currentSelectionObs.value}set currentSelection(t){this.currentSelectionObs.value=t}get history(){return this.historyObs.value}set history(t){this.historyObs.value=t}get isPreviewing(){return this._isPreviewing}set isPreviewing(t){this._isPreviewing=t,t?document.body.classList.add("previewing"):document.body.classList.remove("previewing")}addToHistory(t){if(Array.from(t.values()).some(t=>t)){if(this.history.length>0&&!Array.from(t.entries()).map(([t,e])=>e!==this.history[0].get(t)).some(t=>t))return;this.history.unshift(t),this.historyObs.notify()}}showPreview(t){t.forEach((t,e)=>e.preview=t)}hidePreview(){this.currentSelection.forEach(t=>t.preview=!1)}render(t){const e=new h(t);this.historyItemViews.push(e),e.label=this.historyItemViews.length,this.el.insertBefore(e.el,this.el.childNodes[0]),e.slideIn(250);const i=e=>{const i=Array.from(this.history[0].entries());return new Map(i.map(([i,s])=>{const n=t.has(i)&&t.get(i);return[i,e(n,s)]}))};e.onAnyButtonClick=(t=>{this.canPreview=!1,setTimeout(()=>this.canPreview=!0,375);const e=i(t);e.forEach((t,e)=>e.selected=t),this.addToHistory(e),document.body.classList.remove("previewing")}),e.onAnyButtonEnter=(t=>{const e=i(t);this.canPreview&&(this.showPreview(e),this.isPreviewing=!0)}),e.onAnyButtonLeave=(()=>{this.hidePreview(),this.isPreviewing=!1})}};a.appendChild(d.el),document.body.addEventListener("touchstart",()=>{const t=document.body.scrollTop;0!==t?t+document.body.offsetHeight===document.body.scrollHeight&&(document.body.scrollTop=t-1):document.body.scrollTop=0},{passive:!0,capture:!1}),d.el.addEventListener("touchmove",t=>{t.stopPropagation()},{passive:!0,capture:!1}),d.el.addEventListener("touchend",()=>{document.body.scrollTop=0},!1),document.body.addEventListener("touchmove",t=>{t.preventDefault()},{passive:!1,capture:!1})}]);